apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: aladdindashboards.aladdin.openshift.io
spec:
  group: aladdin.openshift.io
  versions:
  - name: v1alpha1
    served: true
    storage: true
    subresources:
      status: {}
    schema:
      openAPIV3Schema:
        type: object
        description: "AladdinDashboard represents a cluster-scoped dashboard containing Next Gen UI components rendered from Lightspeed API responses"
        required:
        - spec
        properties:
          spec:
            type: object
            description: "AladdinSpec defines the desired state of an Aladdin dashboard"
            required:
            - title
            - layout
            properties:
              title:
                type: string
                description: "Title is the display name for the dashboard"
                maxLength: 255
              description:
                type: string
                description: "Description provides additional context about the dashboard purpose"
                maxLength: 1024
              refreshInterval:
                type: string
                description: "RefreshInterval specifies how often to re-execute all tool calls in the dashboard"
                pattern: "^([0-9]+[smh])+$"
              layout:
                type: object
                description: "Layout defines the dashboard grid system and panel arrangement"
                required:
                - panels
                properties:
                  columns:
                    type: integer
                    description: "Columns defines the number of columns in the grid layout"
                    minimum: 1
                    maximum: 24
                    default: 12
                  panels:
                    type: array
                    description: "Panels contains the dashboard components and their positioning"
                    minItems: 1
                    maxItems: 50
                    items:
                      type: object
                      required:
                      - id
                      - position
                      - component
                      - dataSource
                      properties:
                        id:
                          type: string
                          description: "ID is a unique identifier for the panel within the dashboard"
                          pattern: "^[a-zA-Z0-9][a-zA-Z0-9_-]*$"
                          maxLength: 63
                        title:
                          type: string
                          description: "Title is the display name for the panel"
                          maxLength: 255
                        position:
                          type: object
                          description: "Position defines the panel location and dimensions in the grid"
                          required:
                          - x
                          - y
                          - width
                          - height
                          properties:
                            x:
                              type: integer
                              description: "X coordinate (column position) in the grid"
                              minimum: 0
                            y:
                              type: integer
                              description: "Y coordinate (row position) in the grid"
                              minimum: 0
                            width:
                              type: integer
                              description: "Width in grid columns"
                              minimum: 1
                            height:
                              type: integer
                              description: "Height in grid rows"
                              minimum: 1
                        component:
                          type: object
                          description: "Component defines the Next Gen UI component configuration"
                          required:
                          - type
                          - config
                          properties:
                            type:
                              type: string
                              description: "Type specifies the Next Gen UI component to render"
                              enum:
                              - Chart
                              - Table
                              - Metric
                              - Alert
                              - Log
                              - Resource
                              - Custom
                            config:
                              type: object
                              description: "Config contains component-specific configuration as JSON"
                              x-kubernetes-preserve-unknown-fields: true
                            version:
                              type: string
                              description: "Version specifies the component API version"
                              pattern: "^v[0-9]+((alpha|beta)[0-9]+)?$"
                              default: "v1"
                        dataSource:
                          type: object
                          description: "DataSource contains the tool call information used to retrieve data"
                          required:
                          - toolCall
                          properties:
                            toolCall:
                              type: object
                              description: "ToolCall contains the original MCP tool invocation details"
                              required:
                              - server
                              - tool
                              - arguments
                              properties:
                                server:
                                  type: string
                                  description: "Server identifies the MCP server that handled the request"
                                  enum:
                                  - OpenShiftMCP
                                  - ObservabilityMCP
                                  - CustomMCP
                                tool:
                                  type: string
                                  description: "Tool is the name of the MCP tool that was invoked"
                                  maxLength: 255
                                arguments:
                                  type: object
                                  description: "Arguments contains the parameters passed to the tool call"
                                  x-kubernetes-preserve-unknown-fields: true
                                requestId:
                                  type: string
                                  description: "RequestID links to the original Lightspeed API request"
                                  pattern: "^[a-zA-Z0-9][a-zA-Z0-9_-]*$"
                            cachePolicy:
                              type: string
                              description: "CachePolicy controls data caching behavior for this panel"
                              enum:
                              - NoCache
                              - ShortTerm
                              - LongTerm
                              default: ShortTerm
              tags:
                type: array
                description: "Tags provide metadata for dashboard organization and discovery"
                items:
                  type: string
                  maxLength: 63
                  pattern: "^[a-zA-Z0-9][a-zA-Z0-9_-]*$"
                maxItems: 20
              owner:
                type: string
                description: "Owner identifies the user or service account that created the dashboard"
                maxLength: 255
          status:
            type: object
            description: "AladdinStatus defines the observed state of the dashboard"
            properties:
              observedGeneration:
                type: integer
                description: "ObservedGeneration represents the generation of the spec that was last processed"
                format: int64
  scope: Cluster
  names:
    plural: aladdindashboards
    singular: aladdindashboard
    kind: AladdinDashboard
    shortNames:
    - adash
    - adashboard
    categories:
    - aladdin
    - dashboards